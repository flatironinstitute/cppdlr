\doxysection{utils.\+hpp}
\hypertarget{utils_8hpp_source}{}\label{utils_8hpp_source}\index{/home/runner/work/cppdlr/cppdlr/c++/cppdlr/utils.hpp@{/home/runner/work/cppdlr/cppdlr/c++/cppdlr/utils.hpp}}
\mbox{\hyperlink{utils_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ (c)\ 2022-\/2023\ Simons\ Foundation}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Licensed\ under\ the\ Apache\ License,\ Version\ 2.0\ (the\ "{}License"{});}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ you\ may\ not\ use\ this\ file\ except\ in\ compliance\ with\ the\ License.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ \ \ \ \ http://www.apache.org/licenses/LICENSE-\/2.0.txt}}
\DoxyCodeLine{00008\ \textcolor{comment}{//}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ distributed\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ WITHOUT\ WARRANTIES\ OR\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ See\ the\ License\ for\ the\ specific\ language\ governing\ permissions\ and}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ Authors:\ Jason\ Kaye}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}nda/concepts.hpp"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <nda/nda.hpp>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <nda/blas.hpp>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacecppdlr}{cppdlr}}\ \{}
\DoxyCodeLine{00024\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacecppdlr_a7b5392bb6f0a8155f1f19cab3bd042e9}{dcomplex}}\ =\ std::complex<double>;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcppdlr_1_1barycheb}{barycheb}}\ \{}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00039\ \ \ \ \ \mbox{\hyperlink{classcppdlr_1_1barycheb}{barycheb}}(\textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ nda::vector<double>\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{classcppdlr_1_1barycheb_afac15e0f486dc87d3f550a5b385117de}{getnodes}}();}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classcppdlr_1_1barycheb_ab2f5044a724a2450499000f078b495c3}{interp}}(\textcolor{keywordtype}{double}\ xeval,\ nda::vector\_const\_view<double>\ f);}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00046\ \ \ \ \ nda::vector<double>\ x;\ }
\DoxyCodeLine{00047\ \ \ \ \ nda::vector<double>\ w;\ }
\DoxyCodeLine{00048\ \ \ \};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00059\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcppdlr_1_1baryleg}{baryleg}}\ \{}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{classcppdlr_1_1baryleg}{baryleg}}(\textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ nda::vector<double>\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{classcppdlr_1_1baryleg_ad5488d8c3069e1c6a03684fa0d368cc1}{getnodes}}();}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classcppdlr_1_1baryleg_ab540248ef2bbc19cc6345ad07bc779ed}{interp}}(\textcolor{keywordtype}{double}\ xeval,\ nda::vector\_const\_view<double>\ f);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00069\ \ \ \ \ nda::vector<double>\ x;\ }
\DoxyCodeLine{00070\ \ \ \ \ nda::vector<double>\ w;\ }
\DoxyCodeLine{00071\ \ \ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00083\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacecppdlr_aa355c3aaf829296d7e5869eff98fedd1}{baryinterp}}(nda::vector\_const\_view<double>\ x,\ nda::vector\_const\_view<double>\ w,\ nda::vector\_const\_view<double>\ f,\ \textcolor{keywordtype}{double}\ xeval);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00103\ \ \ \textcolor{comment}{//\ Type\ T\ must\ be\ scalar-\/valued\ rank\ 2\ array/array\_view\ or\ matrix/matrix\_view}}
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArrayOfRank<2>\ T,\ nda::Scalar\ S\ =\ nda::get\_value\_t<T>>}
\DoxyCodeLine{00105\ \ \ std::tuple<typename\ T::regular\_type,\ nda::vector<double>,\ nda::vector<int>>\ \mbox{\hyperlink{namespacecppdlr_a1d0c839b446002a589c9cc22534967b6}{pivrgs}}(T\ \textcolor{keyword}{const}\ \&a,\ \textcolor{keywordtype}{double}\ eps)\ \{}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{auto}\ \_\ =\ nda::range::all;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ Copy\ input\ data}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keyword}{auto}\ aa\ =\ make\_regular(a);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ Get\ matrix\ dimensions}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{auto}\ [m,\ n]\ =\ aa.shape();}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordtype}{int}\ maxrnk\ \ =\ std::min(m,\ n);}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ Compute\ norms\ of\ rows\ of\ input\ matrix,\ and\ rescale\ eps\ tolerance}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{auto}\ norms\ \ \ =\ nda::vector<double>(m);}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{double}\ epssq\ =\ eps\ *\ eps;}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ m;\ ++j)\ \{\ norms(j)\ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ Begin\ pivoted\ double\ Gram-\/Schmidt\ procedure}}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{int}\ jpiv\ =\ 0,\ jj\ =\ 0;}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordtype}{double}\ nrm\ =\ 0;}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keyword}{auto}\ piv\ \ \ =\ nda::arange(m);}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{auto}\ tmp\ \ \ =\ nda::vector<S>(n);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ maxrnk;\ ++j)\ \{}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ next\ pivot}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ jpiv\ =\ j;}
\DoxyCodeLine{00131\ \ \ \ \ \ \ nrm\ \ =\ norms(j);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 1;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ >\ nrm)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ jpiv\ =\ k;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ nrm\ \ =\ norms(k);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \textcolor{comment}{//\ Swap\ current\ row\ with\ chosen\ pivot\ row}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ tmp\ \ \ \ \ \ \ \ \ =\ aa(j,\ \_);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ aa(j,\ \_)\ \ \ \ =\ aa(jpiv,\ \_);}
\DoxyCodeLine{00142\ \ \ \ \ \ \ aa(jpiv,\ \_)\ =\ tmp;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ =\ norms(j);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ norms(j)\ \ \ \ =\ norms(jpiv);}
\DoxyCodeLine{00146\ \ \ \ \ \ \ norms(jpiv)\ =\ nrm;}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \ \ \ \ jj\ \ \ \ \ \ \ \ =\ piv(j);}
\DoxyCodeLine{00149\ \ \ \ \ \ \ piv(j)\ \ \ \ =\ piv(jpiv);}
\DoxyCodeLine{00150\ \ \ \ \ \ \ piv(jpiv)\ =\ jj;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ current\ rows\ (now\ the\ chosen\ pivot\ row)\ against\ all}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{comment}{//\ previously\ chosen\ rows}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j;\ ++k)\ \{\ aa(j,\ \_)\ =\ aa(j,\ \_)\ -\/\ aa(k,\ \_)\ *\ nda::blas::dotc(aa(k,\ \_),\ aa(j,\ \_));\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ norm\ of\ current\ row}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ nrm\ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \textcolor{comment}{//nrm\ =\ nda::norm(aa(j,\ \_));}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{comment}{//\ Terminate\ if\ sufficiently\ small,\ and\ return\ previously\ selected\ rows}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{comment}{//\ (not\ including\ current\ row)}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nrm\ <=\ epssq)\ \{\ \textcolor{keywordflow}{return}\ \{aa(nda::range(0,\ j),\ \_),\ norms(nda::range(0,\ j)),\ piv(nda::range(0,\ j))\};\ \};}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ current\ row}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ aa(j,\ \_)\ =\ aa(j,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 1;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ <=\ epssq)\ \{\ \textcolor{keywordflow}{continue};\ \}\ \textcolor{comment}{//\ Can\ skip\ rows\ with\ norm\ less\ than\ tolerance}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(j,\ \_)\ *\ nda::blas::dotc(aa(j,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordflow}{return}\ \{aa(nda::range(maxrnk),\ \_),\ norms(nda::range(maxrnk)),\ piv(nda::range(maxrnk))\};}
\DoxyCodeLine{00176\ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00201\ \ \ \textcolor{comment}{//\ Type\ T\ must\ be\ scalar-\/valued\ rank\ 2\ array/array\_view\ or\ matrix/matrix\_view}}
\DoxyCodeLine{00202\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArrayOfRank<2>\ T,\ nda::Scalar\ S\ =\ nda::get\_value\_t<T>>}
\DoxyCodeLine{00203\ \ \ std::tuple<typename\ T::regular\_type,\ nda::vector<double>,\ nda::vector<int>>\ \mbox{\hyperlink{namespacecppdlr_ae2becc5e7e7dfe9a59d7a45c309a2e47}{pivrgs\_sym}}(T\ \textcolor{keyword}{const}\ \&a,\ \textcolor{keywordtype}{double}\ eps)\ \{}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{auto}\ \_\ =\ nda::range::all;}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//\ Get\ matrix\ dimensions}}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keyword}{auto}\ [m,\ n]\ =\ a.shape();}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordtype}{int}\ maxrnk\ \ =\ std::min(m,\ n);}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ \%\ 2\ !=\ 0)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Input\ matrix\ must\ have\ even\ number\ of\ rows."{}});\ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ Copy\ input\ data,\ re-\/ordering\ rows\ to\ make\ symmetric\ rows\ adjacent.}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keyword}{auto}\ aa\ =\ \textcolor{keyword}{typename}\ T::regular\_type(m,\ n);}
\DoxyCodeLine{00215\ \ \ \ \ aa(nda::range(0,\ m,\ 2),\ \_)\ =\ a(nda::range(0,\ m\ /\ 2),\ \_);}
\DoxyCodeLine{00216\ \ \ \ \ aa(nda::range(1,\ m,\ 2),\ \_)\ =\ a(nda::range(m\ -\/\ 1,\ m\ /\ 2\ -\/\ 1,\ -\/1),\ \_);}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ Compute\ norms\ of\ rows\ of\ input\ matrix,\ and\ rescale\ eps\ tolerance}}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keyword}{auto}\ norms\ \ \ =\ nda::vector<double>(m);}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordtype}{double}\ epssq\ =\ eps\ *\ eps;}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ m;\ ++j)\ \{\ norms(j)\ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));\ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{comment}{//\ Begin\ pivoted\ double\ Gram-\/Schmidt\ procedure}}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordtype}{int}\ jpiv\ =\ 0,\ jj\ =\ 0;}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordtype}{double}\ nrm\ =\ 0;}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keyword}{auto}\ piv\ \ \ =\ nda::arange(0,\ m);}
\DoxyCodeLine{00227\ \ \ \ \ piv(nda::range(0,\ m,\ 2))\ =\ nda::arange(0,\ m\ /\ 2);\ \textcolor{comment}{//\ Re-\/order\ pivots\ to\ match\ re-\/ordered\ input\ matrix}}
\DoxyCodeLine{00228\ \ \ \ \ piv(nda::range(1,\ m,\ 2))\ =\ nda::arange(m\ -\/\ 1,\ m\ /\ 2\ -\/\ 1,\ -\/1);}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keyword}{auto}\ tmp\ =\ nda::vector<S>(n);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}\ (maxrnk\ \%\ 2\ !=\ 0)\ \{\ \textcolor{comment}{//\ If\ n\ <\ m\ and\ n\ is\ odd,\ decrease\ maxrnk\ to\ maintain\ symmetry}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ maxrnk\ -\/=\ 1;}
\DoxyCodeLine{00233\ \ \ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ maxrnk;\ j\ +=\ 2)\ \{}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ next\ pair\ of\ pivots}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ jpiv\ =\ j;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ nrm\ \ =\ norms(j)\ +\ norms(j\ +\ 1);}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 2;\ k\ <\ m;\ k\ +=\ 2)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ +\ norms(k\ +\ 1)\ >\ nrm)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ jpiv\ =\ k;}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ nrm\ \ =\ norms(k)\ +\ norms(k\ +\ 1);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{comment}{//\ Swap\ current\ row\ pair\ with\ chosen\ pivot\ row\ pair}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ tmp\ \ \ \ \ \ \ \ \ \ \ \ \ =\ aa(j,\ \_);}
\DoxyCodeLine{00249\ \ \ \ \ \ \ aa(j,\ \_)\ \ \ \ \ \ \ \ =\ aa(jpiv,\ \_);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ aa(jpiv,\ \_)\ \ \ \ \ =\ tmp;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ tmp\ \ \ \ \ \ \ \ \ \ \ \ \ =\ aa(j\ +\ 1,\ \_);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ aa(j\ +\ 1,\ \_)\ \ \ \ =\ aa(jpiv\ +\ 1,\ \_);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ aa(jpiv\ +\ 1,\ \_)\ =\ tmp;}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ \ \ \ =\ norms(j);}
\DoxyCodeLine{00256\ \ \ \ \ \ \ norms(j)\ \ \ \ \ \ \ \ =\ norms(jpiv);}
\DoxyCodeLine{00257\ \ \ \ \ \ \ norms(jpiv)\ \ \ \ \ =\ nrm;}
\DoxyCodeLine{00258\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ \ \ \ =\ norms(j\ +\ 1);}
\DoxyCodeLine{00259\ \ \ \ \ \ \ norms(j\ +\ 1)\ \ \ \ =\ norms(jpiv\ +\ 1);}
\DoxyCodeLine{00260\ \ \ \ \ \ \ norms(jpiv\ +\ 1)\ =\ nrm;}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ jj\ \ \ \ \ \ \ \ \ \ \ \ =\ piv(j);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ piv(j)\ \ \ \ \ \ \ \ =\ piv(jpiv);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ piv(jpiv)\ \ \ \ \ =\ jj;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ jj\ \ \ \ \ \ \ \ \ \ \ \ =\ piv(j\ +\ 1);}
\DoxyCodeLine{00266\ \ \ \ \ \ \ piv(j\ +\ 1)\ \ \ \ =\ piv(jpiv\ +\ 1);}
\DoxyCodeLine{00267\ \ \ \ \ \ \ piv(jpiv\ +\ 1)\ =\ jj;}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ current\ row\ (now\ the\ first\ chosen\ pivot\ row)\ against\ all}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \textcolor{comment}{//\ previously\ chosen\ rows}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j;\ ++k)\ \{\ aa(j,\ \_)\ =\ aa(j,\ \_)\ -\/\ aa(k,\ \_)\ *\ nda::blas::dotc(aa(k,\ \_),\ aa(j,\ \_));\ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ norm\ of\ current\ row}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ nrm\ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{comment}{//\ Terminate\ if\ sufficiently\ small,\ and\ return\ previously\ selected\ rows}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \textcolor{comment}{//\ (not\ including\ current\ row)}}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nrm\ <=\ epssq)\ \{\ \textcolor{keywordflow}{return}\ \{aa(nda::range(0,\ j),\ \_),\ norms(nda::range(0,\ j)),\ piv(nda::range(0,\ j))\};\ \};}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ current\ row}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ aa(j,\ \_)\ =\ aa(j,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 1;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ <=\ epssq)\ \{\ \textcolor{keywordflow}{continue};\ \}\ \textcolor{comment}{//\ Can\ skip\ rows\ with\ norm\ less\ than\ tolerance}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(j,\ \_)\ *\ nda::blas::dotc(aa(j,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ current\ row\ (now\ the\ second\ chosen\ pivot\ row)\ against\ all}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \textcolor{comment}{//\ previously\ chosen\ rows}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j\ +\ 1;\ ++k)\ \{\ aa(j\ +\ 1,\ \_)\ =\ aa(j\ +\ 1,\ \_)\ -\/\ aa(k,\ \_)\ *\ nda::blas::dotc(aa(k,\ \_),\ aa(j\ +\ 1,\ \_));\ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ current\ row}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ =\ nda::real(nda::blas::dotc(aa(j\ +\ 1,\ \_),\ aa(j\ +\ 1,\ \_)));}
\DoxyCodeLine{00296\ \ \ \ \ \ \ aa(j\ +\ 1,\ \_)\ =\ aa(j\ +\ 1,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 2;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ <=\ epssq)\ \{\ \textcolor{keywordflow}{continue};\ \}\ \textcolor{comment}{//\ Can\ skip\ rows\ with\ norm\ less\ than\ tolerance}}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(j\ +\ 1,\ \_)\ *\ nda::blas::dotc(aa(j\ +\ 1,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordflow}{return}\ \{aa(nda::range(maxrnk),\ \_),\ norms(nda::range(maxrnk)),\ piv(nda::range(maxrnk))\};}
\DoxyCodeLine{00307\ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00334\ \ \ \textcolor{comment}{//\ Type\ T\ must\ be\ scalar-\/valued\ rank\ 2\ array/array\_view\ or\ matrix/matrix\_view}}
\DoxyCodeLine{00335\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArrayOfRank<2>\ T,\ nda::Scalar\ S\ =\ nda::get\_value\_t<T>>}
\DoxyCodeLine{00336\ \ \ std::tuple<typename\ T::regular\_type,\ nda::vector<double>,\ nda::vector<int>>\ \mbox{\hyperlink{namespacecppdlr_ae2becc5e7e7dfe9a59d7a45c309a2e47}{pivrgs\_sym}}(T\ \textcolor{keyword}{const}\ \&a,\ \textcolor{keywordtype}{int}\ r)\ \{}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keyword}{auto}\ \_\ =\ nda::range::all;}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{comment}{//\ Get\ matrix\ dimensions}}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keyword}{auto}\ [m,\ n]\ =\ a.shape();}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ \%\ 2\ ==\ 1\ \&\&\ r\ \%\ 2\ ==\ 0)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}If\ input\ matrix\ has\ odd\ number\ of\ rows,\ r\ must\ be\ odd."{}});\ \}}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ \%\ 2\ ==\ 1\ \&\&\ m\ \%\ 2\ ==\ 0)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}If\ r\ is\ odd,\ input\ matrix\ must\ have\ odd\ number\ of\ rows."{}});\ \}}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ >\ m\ ||\ r\ >\ n\ +\ 1)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}r\ must\ be\ less\ than\ or\ equal\ to\ min(m,n+1)."{}});\ \}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ ==\ n\ +\ 1\ \&\&\ (n\ \%\ 2\ ==\ 1\ ||\ n\ >\ m))\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}If\ r\ =\ n+1,\ n\ must\ be\ even\ and\ less\ than\ or\ equal\ to\ m."{}});\ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{comment}{//\ Copy\ input\ data,\ re-\/ordering\ rows\ to\ make\ symmetric\ rows\ adjacent.\ If\ m}}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{comment}{//\ odd,\ put\ middle\ row\ at\ the\ end.}}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keyword}{auto}\ aa\ =\ \textcolor{keyword}{typename}\ T::regular\_type(m,\ n);}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ \%\ 2\ ==\ 0)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ aa(nda::range(0,\ m,\ 2),\ \_)\ =\ a(nda::range(0,\ m\ /\ 2),\ \_);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ aa(nda::range(1,\ m,\ 2),\ \_)\ =\ a(nda::range(m\ -\/\ 1,\ m\ /\ 2\ -\/\ 1,\ -\/1),\ \_);}
\DoxyCodeLine{00354\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ aa(0,\ \_)\ =\ a((m\ -\/\ 1)\ /\ 2,\ \_);}
\DoxyCodeLine{00356\ \ \ \ \ \ \ aa(nda::range(1,\ m,\ 2),\ \_)\ =\ a(nda::range(0,\ (m\ -\/\ 1)\ /\ 2),\ \_);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ aa(nda::range(2,\ m,\ 2),\ \_)\ =\ a(nda::range(m\ -\/\ 1,\ (m\ -\/\ 1)\ /\ 2,\ -\/1),\ \_);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \textcolor{comment}{//aa(m\ -\/\ 1,\ \_)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ a((m\ -\/\ 1)\ /\ 2,\ \_);}}
\DoxyCodeLine{00359\ \ \ \ \ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{comment}{//\ Compute\ norms\ of\ rows\ of\ input\ matrix}}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keyword}{auto}\ norms\ =\ nda::vector<double>(m);}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ m;\ ++j)\ \{\ norms(j)\ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));\ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{comment}{//\ Begin\ pivoted\ double\ Gram-\/Schmidt\ procedure}}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{int}\ jpiv\ =\ 0,\ jj\ =\ 0;}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordtype}{double}\ nrm\ =\ 0;}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keyword}{auto}\ piv\ \ \ =\ nda::arange(0,\ m);}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ \%\ 2\ ==\ 0)\ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ piv(nda::range(0,\ m,\ 2))\ =\ nda::arange(0,\ m\ /\ 2);\ \textcolor{comment}{//\ Re-\/order\ pivots\ to\ match\ re-\/ordered\ input\ matrix}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ piv(nda::range(1,\ m,\ 2))\ =\ nda::arange(m\ -\/\ 1,\ m\ /\ 2\ -\/\ 1,\ -\/1);}
\DoxyCodeLine{00372\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ piv(0)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ (m\ -\/\ 1)\ /\ 2;}
\DoxyCodeLine{00374\ \ \ \ \ \ \ piv(nda::range(1,\ m,\ 2))\ =\ nda::arange(0,\ (m\ -\/\ 1)\ /\ 2);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ piv(nda::range(2,\ m,\ 2))\ =\ nda::arange(m\ -\/\ 1,\ (m\ -\/\ 1)\ /\ 2,\ -\/1);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \textcolor{comment}{//piv(m\ -\/\ 1)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ (m\ -\/\ 1)\ /\ 2;}}
\DoxyCodeLine{00377\ \ \ \ \ \}}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keyword}{auto}\ tmp\ =\ nda::vector<S>(n);}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{comment}{//\ If\ m\ odd,\ first\ choose\ middle\ row\ (now\ last\ row)\ as\ first\ pivot}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ \%\ 2\ ==\ 1)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{comment}{//int\ j\ =\ 0;\ \ \ \ \ //\ Index\ of\ current\ row}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \textcolor{comment}{//jpiv\ \ =\ 0;\ //\ Index\ of\ pivot\ row}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ nrm\ \ \ \ \ \ =\ nda::real(nda::blas::dotc(aa(0,\ \_),\ aa(0,\ \_)));}
\DoxyCodeLine{00388\ \ \ \ \ \ \ aa(0,\ \_)\ =\ aa(0,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \textcolor{comment}{//aa(0,\ \_)\ /=\ sqrt(nda::real(nda::blas::dotc(aa(0,\ \_),\ aa(0,\ \_))));}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 1;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(0,\ \_)\ *\ nda::blas::dotc(aa(0,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00396\ \ \ \ \ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordtype}{int}\ jstrt\ =\ (m\ \%\ 2\ ==\ 1)\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{comment}{//\ Then\ proceed\ with\ pivoted\ GS\ algorithm\ as\ normal}}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ jstrt;\ j\ <\ r;\ j\ +=\ 2)\ \{}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ next\ pair\ of\ pivots}}
\DoxyCodeLine{00403\ \ \ \ \ \ \ jpiv\ =\ j;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ nrm\ \ =\ norms(j)\ +\ norms(j\ +\ 1);}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 2;\ k\ <\ m;\ k\ +=\ 2)\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norms(k)\ +\ norms(k\ +\ 1)\ >\ nrm)\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ jpiv\ =\ k;}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ nrm\ \ =\ norms(k)\ +\ norms(k\ +\ 1);}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{comment}{//\ Swap\ current\ row\ pair\ with\ chosen\ pivot\ row\ pair}}
\DoxyCodeLine{00413\ \ \ \ \ \ \ tmp\ \ \ \ \ \ \ \ \ \ \ \ \ =\ aa(j,\ \_);}
\DoxyCodeLine{00414\ \ \ \ \ \ \ aa(j,\ \_)\ \ \ \ \ \ \ \ =\ aa(jpiv,\ \_);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ aa(jpiv,\ \_)\ \ \ \ \ =\ tmp;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ tmp\ \ \ \ \ \ \ \ \ \ \ \ \ =\ aa(j\ +\ 1,\ \_);}
\DoxyCodeLine{00417\ \ \ \ \ \ \ aa(j\ +\ 1,\ \_)\ \ \ \ =\ aa(jpiv\ +\ 1,\ \_);}
\DoxyCodeLine{00418\ \ \ \ \ \ \ aa(jpiv\ +\ 1,\ \_)\ =\ tmp;}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ \ \ \ =\ norms(j);}
\DoxyCodeLine{00421\ \ \ \ \ \ \ norms(j)\ \ \ \ \ \ \ \ =\ norms(jpiv);}
\DoxyCodeLine{00422\ \ \ \ \ \ \ norms(jpiv)\ \ \ \ \ =\ nrm;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ \ \ \ =\ norms(j\ +\ 1);}
\DoxyCodeLine{00424\ \ \ \ \ \ \ norms(j\ +\ 1)\ \ \ \ =\ norms(jpiv\ +\ 1);}
\DoxyCodeLine{00425\ \ \ \ \ \ \ norms(jpiv\ +\ 1)\ =\ nrm;}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \ \ \ \ jj\ \ \ \ \ \ \ \ \ \ \ \ =\ piv(j);}
\DoxyCodeLine{00428\ \ \ \ \ \ \ piv(j)\ \ \ \ \ \ \ \ =\ piv(jpiv);}
\DoxyCodeLine{00429\ \ \ \ \ \ \ piv(jpiv)\ \ \ \ \ =\ jj;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ jj\ \ \ \ \ \ \ \ \ \ \ \ =\ piv(j\ +\ 1);}
\DoxyCodeLine{00431\ \ \ \ \ \ \ piv(j\ +\ 1)\ \ \ \ =\ piv(jpiv\ +\ 1);}
\DoxyCodeLine{00432\ \ \ \ \ \ \ piv(jpiv\ +\ 1)\ =\ jj;}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ current\ row\ (now\ the\ first\ chosen\ pivot\ row)\ against\ all}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \textcolor{comment}{//\ previously\ chosen\ rows}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j;\ ++k)\ \{\ aa(j,\ \_)\ =\ aa(j,\ \_)\ -\/\ aa(k,\ \_)\ *\ nda::blas::dotc(aa(k,\ \_),\ aa(j,\ \_));\ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ current\ row}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ nrm\ \ \ \ \ \ =\ nda::real(nda::blas::dotc(aa(j,\ \_),\ aa(j,\ \_)));}
\DoxyCodeLine{00440\ \ \ \ \ \ \ aa(j,\ \_)\ =\ aa(j,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 1;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(j,\ \_)\ *\ nda::blas::dotc(aa(j,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ current\ row\ (now\ the\ second\ chosen\ pivot\ row)\ against\ all}}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \textcolor{comment}{//\ previously\ chosen\ rows}}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j\ +\ 1;\ ++k)\ \{\ aa(j\ +\ 1,\ \_)\ =\ aa(j\ +\ 1,\ \_)\ -\/\ aa(k,\ \_)\ *\ nda::blas::dotc(aa(k,\ \_),\ aa(j\ +\ 1,\ \_));\ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ current\ row}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ nrm\ \ \ \ \ \ \ \ \ \ =\ nda::real(nda::blas::dotc(aa(j\ +\ 1,\ \_),\ aa(j\ +\ 1,\ \_)));}
\DoxyCodeLine{00454\ \ \ \ \ \ \ aa(j\ +\ 1,\ \_)\ =\ aa(j\ +\ 1,\ \_)\ *\ (1\ /\ sqrt(nrm));}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \textcolor{comment}{//\ Orthogonalize\ remaining\ rows\ against\ current\ row}}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 2;\ k\ <\ m;\ ++k)\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ aa(k,\ \_)\ =\ aa(k,\ \_)\ -\/\ aa(j\ +\ 1,\ \_)\ *\ nda::blas::dotc(aa(j\ +\ 1,\ \_),\ aa(k,\ \_));}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ norms(k)\ =\ nda::real(nda::blas::dotc(aa(k,\ \_),\ aa(k,\ \_)));}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{keywordflow}{return}\ \{aa(nda::range(r),\ \_),\ norms(nda::range(r)),\ piv(nda::range(r))\};}
\DoxyCodeLine{00464\ \ \ \}}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00473\ \ \ nda::vector<double>\ \mbox{\hyperlink{namespacecppdlr_a2d46bf12944fe36c90343df67e2d783b}{eqptsrel}}(\textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00490\ \ \ nda::vector<double>\ \mbox{\hyperlink{namespacecppdlr_a3b1ccba6393dfc517757677a13ad2553}{rel2abs}}(nda::vector\_const\_view<double>\ t);}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacecppdlr_a3b1ccba6393dfc517757677a13ad2553}{rel2abs}}(\textcolor{keywordtype}{double}\ t);}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00516\ \ \ nda::vector<double>\ \mbox{\hyperlink{namespacecppdlr_a103a8aae4c8af512d2682d381a676561}{abs2rel}}(nda::vector\_const\_view<double>\ t\_abs);}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00521\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{namespacecppdlr_a103a8aae4c8af512d2682d381a676561}{abs2rel}}(\textcolor{keywordtype}{double}\ t\_abs);}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00526\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArray\ T>\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacecppdlr_af914cc6f80f2a540846205c0a2ae1b73}{make\_real\_t}}\ =\ \textcolor{keyword}{decltype}(make\_regular(nda::real(std::declval<T>())));}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00531\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArray\ T>\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacecppdlr_af7426dd83d2c831f6ae3fa9b8e6172ad}{make\_cplx\_t}}\ =\ \textcolor{keyword}{decltype}(make\_regular(std::declval<T>()\ *\ 1i));}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00537\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArray\ T,\ nda::Scalar\ S1,\ nda::Scalar\ S2>\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structcppdlr_1_1make__common__helper}{make\_common\_helper}}\ \{}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structcppdlr_1_1make__common__helper_af2b0051f601013d1a403cff27d6719b4}{S}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\ std::common\_type\_t<S1,\ S2>;}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{structcppdlr_1_1make__common__helper_af2b0051f601013d1a403cff27d6719b4}{S}}\ \mbox{\hyperlink{structcppdlr_1_1make__common__helper_a2d4aae79d5de09d01c41489d92939392}{x}}\ =\ 0;}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{structcppdlr_1_1make__common__helper_a107dd2255fe65dc6a5575ccd059d42c9}{type}}\ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keyword}{decltype}(make\_regular(std::declval<T>()\ *\ \mbox{\hyperlink{structcppdlr_1_1make__common__helper_a2d4aae79d5de09d01c41489d92939392}{x}}));}
\DoxyCodeLine{00541\ \ \ \};}
\DoxyCodeLine{00542\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArray\ T,\ nda::Scalar\ S1,\ nda::Scalar\ S2>\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespacecppdlr_ac23dfec829ec6ed8deec469faeea3981}{make\_common\_t}}\ =\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{structcppdlr_1_1make__common__helper_a107dd2255fe65dc6a5575ccd059d42c9}{make\_common\_helper<T,\ S1,\ S2>::type}};}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00553\ \ \ \textcolor{keyword}{template}\ <nda::MemoryArray\ Ta,\ nda::MemoryArray\ Tb,\ nda::Scalar\ Sa\ =\ nda::get\_value\_t<Ta>,\ nda::Scalar\ Sb\ =\ nda::get\_value\_t<Tb>,}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ nda::Scalar\ S\ =\ \textcolor{keyword}{typename}\ std::common\_type<Sa,\ Sb>::type>}
\DoxyCodeLine{00555\ \ \ nda::array<S,\ Ta::rank\ +\ Tb::rank\ -\/\ 2>\ \mbox{\hyperlink{namespacecppdlr_a623b3f78817239e2d1653be8972cc5f1}{arraymult}}(Ta\ \textcolor{keyword}{const}\ \&a,\ Tb\ \textcolor{keyword}{const}\ \&b)\ \{}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{comment}{//\ Get\ ranks\ of\ input\ arrays}}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ ra\ =\ Ta::rank;}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ rb\ =\ Tb::rank;}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \textcolor{comment}{//\ Get\ inner\ dimensions\ of\ input\ arrays}}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordtype}{int}\ p\ =\ a.shape(ra\ -\/\ 1);}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{if}\ (b.shape(0)\ !=\ p)\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}last\ dim\ of\ a\ !=\ first\ dim\ of\ b"{}});}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{comment}{//\ Get\ product\ of\ outer\ dimensions\ of\ input\ arrays}}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keywordtype}{int}\ m\ =\ a.size()\ /\ p;}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ b.size()\ /\ p;}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{comment}{//\ Reshape\ input\ arrays\ to\ 2D\ arrays}}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keyword}{auto}\ a\_reshaped\ =\ nda::reshape(a,\ m,\ p);}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keyword}{auto}\ b\_reshaped\ =\ nda::reshape(b,\ p,\ n);}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \ \ \ \ \textcolor{comment}{//\ Get\ shape\ of\ output\ array}}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{auto}\ c\_shape\ =\ std::array<int,\ ra\ +\ rb\ -\/\ 2>();}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ ra\ -\/\ 1;\ ++i)\ \{\ c\_shape[i]\ =\ a.shape(i);\ \}}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ ra\ -\/\ 1;\ i\ <\ ra\ +\ rb\ -\/\ 2;\ ++i)\ \{\ c\_shape[i]\ =\ b.shape(i\ -\/\ ra\ +\ 2);\ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ contraction,\ reshape,\ and\ return}}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{keywordflow}{return}\ reshape(matmul(a\_reshaped,\ b\_reshaped),\ c\_shape);}
\DoxyCodeLine{00580\ \ \ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00603\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ S>}
\DoxyCodeLine{00604\ \ \ \textcolor{comment}{//\ TODO:\ require\ S\ is\ scalar}}
\DoxyCodeLine{00605\ \ \ S\ \mbox{\hyperlink{namespacecppdlr_a93826a1ab8ed29d304e0194fefd4e19c}{adapgl}}(std::function<nda::array<S,\ 1>(nda::array<double,\ 1>)>\ f,\ \textcolor{keywordtype}{double}\ a,\ \textcolor{keywordtype}{double}\ b,\ \textcolor{keywordtype}{double}\ tol,\ nda::vector<double>\ xgl,}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ nda::vector<double>\ wgl)\ \{}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordtype}{int}\ maxnde\ =\ 100000;\ \textcolor{comment}{//\ Max\ nodes\ in\ integration\ tree}}
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{keywordtype}{int}\ maxstk\ =\ 1000;\ \ \ \textcolor{comment}{//\ Max\ stack\ size}}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ \ \ S\ sum\ =\ 0;\ \textcolor{comment}{//\ Integral}}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{comment}{//\ Initialize\ stack:\ there\ is\ a\ stack\ of\ interval\ endpoints\ associated\ w/}}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{comment}{//\ each\ node\ in\ the\ integration\ tree,\ and\ a\ corresponding\ stack\ of\ values}}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{comment}{//\ associated\ w/\ each\ such\ interval}}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keyword}{auto}\ endpt\ =\ nda::array<double,\ 2>(maxstk,\ 2);\ \textcolor{comment}{//\ Stack\ of\ interval\ endpoints}}
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keyword}{auto}\ sums\ \ =\ nda::array<S,\ 1>(maxstk);\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Stack\ of\ sums\ associated\ w/\ each\ interval}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{keywordtype}{int}\ istk\ =\ 0;\ \textcolor{comment}{//\ Stack\ pointer}}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordtype}{int}\ nnde\ =\ 1;\ \textcolor{comment}{//\ Number\ of\ nodes\ in\ integration\ tree}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \ \ endpt(istk,\ 0)\ =\ a;\ \textcolor{comment}{//\ Root\ node\ interval\ is\ [a,b]}}
\DoxyCodeLine{00624\ \ \ \ \ endpt(istk,\ 1)\ =\ b;}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordtype}{double}\ h\ \ \ =\ (b\ -\/\ a)\ /\ 2;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Interval\ half-\/width}}
\DoxyCodeLine{00627\ \ \ \ \ sums(istk)\ =\ h\ *\ nda::blas::dotc(wgl,\ f(xgl\ *\ h\ +\ (a\ +\ b)\ /\ 2));\ \textcolor{comment}{//\ Integral\ of\ f\ on\ root\ node\ interval}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \ \ \textcolor{keywordtype}{double}\ aa\ =\ 0,\ bb\ =\ 0,\ cc\ =\ 0;\ \textcolor{comment}{//\ Interval\ endpoints,\ midpoint}}
\DoxyCodeLine{00630\ \ \ \ \ S\ sum1\ =\ 0,\ sum2\ =\ 0;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Integrals\ on\ subintervals}}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{comment}{//\ Main\ loop}}
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \ \ \ \ \ \ aa\ =\ endpt(istk,\ 0);\ \textcolor{comment}{//\ Get\ interval\ endpoints}}
\DoxyCodeLine{00636\ \ \ \ \ \ \ bb\ =\ endpt(istk,\ 1);}
\DoxyCodeLine{00637\ \ \ \ \ \ \ cc\ =\ (aa\ +\ bb)\ /\ 2;\ \textcolor{comment}{//\ Get\ midpoint}}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ integral\ on\ each\ subinterval}}
\DoxyCodeLine{00640\ \ \ \ \ \ \ h\ \ \ \ =\ (cc\ -\/\ aa)\ /\ 2;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ sum1\ =\ h\ *\ nda::blas::dotc(wgl,\ f(xgl\ *\ h\ +\ (aa\ +\ cc)\ /\ 2));}
\DoxyCodeLine{00642\ \ \ \ \ \ \ sum2\ =\ h\ *\ nda::blas::dotc(wgl,\ f(xgl\ *\ h\ +\ (cc\ +\ bb)\ /\ 2));}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ error\ on\ subintervals\ is\ less\ than\ tolerance,\ add\ to\ integral\ and}}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \textcolor{comment}{//\ move\ to\ next\ node}}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00647\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(sum1\ +\ sum2\ -\/\ sums(istk))\ <\ tol)\ \{}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ sum\ +=\ sum1\ +\ sum2;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ to\ subintervals\ to\ integral}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ istk-\/-\/;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ current\ interval\ from\ stack}}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (istk\ <\ 0)\ \{\ \textcolor{keywordflow}{return}\ sum;\ \}\ \textcolor{comment}{//\ If\ stack\ is\ empty,\ return\ integral}}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Integral\ on\ current\ interval\ not\ converged}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ current\ interval\ from\ stack,\ and\ add\ subintervals}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ endpt(istk,\ 1)\ \ \ \ \ =\ cc;}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ endpt(istk\ +\ 1,\ 0)\ =\ cc;}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ endpt(istk\ +\ 1,\ 1)\ =\ bb;}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ sums(istk)\ \ \ \ \ \ \ \ \ =\ sum1;}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ sums(istk\ +\ 1)\ \ \ \ \ =\ sum2;}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ istk++;}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ nnde\ +=\ 2;}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (istk\ >\ maxstk)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}integration\ stack\ too\ large"{}});\ \}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nnde\ >\ maxnde)\ \{\ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}integration\ tree\ too\ large"{}});\ \}}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00666\ \ \ \ \ \}}
\DoxyCodeLine{00667\ \ \ \}}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00678\ \ \ std::tuple<nda::vector<double>,\ nda::vector<double>>\ \mbox{\hyperlink{namespacecppdlr_afbfcb627a6ab1115bb02670e7ce61219}{gaussquad}}(\textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{00679\ }
\DoxyCodeLine{00690\ \ \ std::tuple<double,\ double>\ \mbox{\hyperlink{namespacecppdlr_adcede29d3876b4a265f09a56db33085d}{leg\_eval}}(\textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{double}\ x);}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \}\ \textcolor{comment}{//\ namespace\ cppdlr}}

\end{DoxyCode}
